<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
        <link href='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css'
        rel='stylesheet' />
        <title>Choropleth</title>
        <style>
                 body {
            padding-left: 0px;
            padding-right: 0px;
            margin: 0;
            height: 100%;
        }
        
        html {
            height: 100%;
        }

    @media only screen  and (min-width : 800px) {
        #mapid{ 
              height:100%; 
              width: 100%;
              position: absolute;
              float: left;
              top: 1%;
              height: 98%;
              width: 100%;
              z-index: 1;
                }
          path.leaflet-clickable{stroke-width: .7;}
            .info {
                padding: 6px 8px;
                font: 16px/18px Arial, Helvetica, sans-serif;
                background: rgba(255,255,255,0);
                box-shadow: 0 0 0px rgba(0,0,0,0.2);
                border-radius: 5px;
                float: right;
                text-align: left;
                max-width: 500px;
            }
            .info p{ 
                margin: 0 15 0px;
                font-size: 24px;
                line-height: 30px;
                font-style: italic;
            }
            .info h4 {
                margin: 0 0 0px;
                color: #555;
                font-size: 36px;
                margin-bottom: 30px;
                line-height: 45px;
                font-weight: 700;
                text-align: left;
                font-family: Georgia, Times, "Times New Roman", serif;
                
            }
            .legend {
                line-height: 60px;
                color: white;
                font-weight: 600;
                width: 110px;
                margin-top: 50px;

            }
            .legend i {
                width: 100px;
                height: 60px;
                margin-right: 8px;
                opacity: 0.7;
                text-align: center;
                float: left;
                font-size: 20px;

            }
            b {
                font-size: 24px;
            }
        }

    @media only screen and (min-device-width : 501px) and (max-device-width : 800px) {
        #mapid{ 
              height:100%; 
              width: 100%;
              position: absolute;
              float: left;
              top: 1%;
              height: 98%;
              width: 100%;
              z-index: 1;
                }
          path.leaflet-clickable{stroke-width: .7;}
            .info {
                padding: 6px 8px;
                font: 16px/18px Arial, Helvetica, sans-serif;
                background: rgba(255,255,255,0);
                box-shadow: 0 0 0px rgba(0,0,0,0.2);
                border-radius: 5px;
                float: right;
                text-align: left;
                max-width: 400px;
            }
            .info p{ 
                margin: 0 0 0px;
                font-size: 22px;
                line-height: 28px;
                font-style: italic;
            }
            .info h4 {
                margin: 0 0 0px;
                color: #555;
                font-size: 30px;
                margin-bottom: 30px;
                line-height: 36px;
                font-weight: 700;
                text-align: left;
                font-family: Georgia, Times, "Times New Roman", serif;
                
            }
            .legend {
                line-height: 60px;
                color: white;
                font-weight: 600;
                width: 110px;
                margin-top: 50px;

            }
            .legend i {
                width: 100px;
                height: 60px;
                margin-right: 8px;
                opacity: 0.7;
                text-align: center;
                float: left;
                font-size: 20px;

            }
            b {
                font-size: 24px;
            }
        }
    @media only screen and (max-width : 500px) {
 
          #mapid{ 
              height:100%; 
              width: 100%;
              position: absolute;
              float: left;
              top: 1%;
              height: 98%;
              width: 100%;
              z-index: 1;
                }
          path.leaflet-clickable{stroke-width: .7;}
            .info {
                padding: 6px 8px;
                font: 10px/14px Arial, Helvetica, sans-serif;
                background: rgba(255,255,255,0);
                box-shadow: 0 0 0px rgba(0,0,0,0.2);
                border-radius: 5px;
                float: right;
                text-align: left;
                max-width: 200px;
            }
            .info p{ 
                font-size: 16px;
                line-height: 20px;
                float: right;
                margin: 0 0 0px;
                font-style: italic;

            }
            .info h4 {
                margin: 0 0 0px;
                color: #555;
                font-size: 24px;
                margin-bottom: 10px;
                line-height: 22px;
                font-weight: 700;
                text-align: left;
                font-family: Georgia, Times, "Times New Roman", serif;
                
            }
            .legend {
                line-height: 40px;
                color: white;
                font-weight: 600;
                width: 70px;
                margin-top: 20px;

            }
            .legend i {
                width: 70px;
                height: 40px;
                margin-right: 8px;
                opacity: 0.7;
                text-align: center;
                float: left;
                font-size: 16px;


            }
            b {
                font-size: 10px;
            }
        }
        </style>
    </head>
    <body>
     <div id="mapid">MapID</div>
        <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
        <script src="aj-geo2.js"></script>
        <script type="text/javascript">

            var mymap = L.map('mapid', { zoomControl:false}).setView([26.6305, -80.0000],11);
            var positron = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
              attribution: 'Justin Price &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
              maxZoom: 12,
              minZoom: 11,
              id: 'qstin.jhebfo41',
              accessToken: 'pk.eyJ1IjoicXN0aW4iLCJhIjoiWUtYVWpZcyJ9.wum0qrqdX6ASx0OMIg7RLg'
              /* ' pk.eyJ1IjoicGJwb3N0IiwiYSI6ImNpcDhyZDVmMjAxZDd0Y25ydW5xMDNnNGMifQ.R93usutIGqXjUL1IgrDkyw'*/
            }).addTo(mymap);
            L.geoJson(precinctData).addTo(mymap);
            function getColor(d) {
              return d > 78.0 ? '#b2182b' :
                     d > 62.0 ? '#ef8a62' :
                     d > 50.0 ? '#fddbc7' :
                     d > 31.0 ? '#e0e0e0' :
                     d > 16.0 ? '#999999' :
                                '#4d4d4d';//below the above number
              }
              
            function style(feature) {
              return {
                  fillColor: getColor(feature.properties.ajvbm_percent_for_Jacquet),
                  weight: 1,
                  opacity: 1,
                  color: 'white',
                  dashArray: '',
                  fillOpacity: .5
                  };
              }
            L.geoJson(precinctData, {style: style}).addTo(mymap);

            function highlightFeature(e) {
              var layer = e.target;
              info.update(layer.feature.properties);
              layer.setStyle({
                  weight: 1,
                  color: 'white',
                  dashArray: '',
                  fillOpacity: .4
              });

              if (!L.Browser.ie && !L.Browser.opera) {
                  layer.bringToFront();
                  }
              }
            function resetHighlight(e) {
              geojson.resetStyle(e.target);
              info.update();
              }
            function onEachFeature(feature, layer) {
              layer.on({
                  mouseover: highlightFeature,
                  mouseout: resetHighlight,
                  click: highlightFeature
                  });
              }
              geojson = L.geoJson(precinctData, {
                  style: style,
                  onEachFeature: onEachFeature
              }).addTo(mymap);
              
              var info = L.control({position: 'bottomright'});


              info.onAdd = function (map) {
                this._div = L.DomUtil.create('div', 'info');
                this.update();
                return this._div;

              };
              info.update = function (props) {
                this._div.innerHTML = '<h4>Percent of mail-in votes cast for Al Jacquet by precinct</h4>' +
                                      '<p>Jacquet campaigned heavily in southern parts of Palm Beach County, where ' +
                                      'voters cast inordinate amounts of votes by mail.</p>'
              };
              info.addTo(mymap);
              var legend = L.control({position: 'topright'});
              info.getContainer().addEventListener('mouseover', function () {
                    map.dragging.disable();
                });

                // Re-enable dragging when user's cursor leaves the element
                info.getContainer().addEventListener('mouseout', function () {
                    map.dragging.enable();
                });

              legend.onAdd = function (mymap) {

                var div = L.DomUtil.create('div', 'info legend'),
                    grades = [0, 16, 31, 50, 62, 78],
                    labels = [];

                // loop through our density intervals and generate a label with a colored square for each interval
                for (var i = 0; i < grades.length; i++) {
                    if (i >= 2 || i == 3) {
                        div.innerHTML += 
                            '<i style="color: black;background:' + getColor(grades[i] + 1) +'"> ' +
                            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '%</i>' : '+');
                    }
                    else {
                        div.innerHTML += 
                            '<i style="background:' + getColor(grades[i] + 1) + '"> ' +
                            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '%</i></br>' : '+');
                    }
                }
                return div;
              };

            legend.addTo(mymap);

            


                </script>


   </body>
</html>
